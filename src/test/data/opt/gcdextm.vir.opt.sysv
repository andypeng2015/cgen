module gcdextm

export function $gcdext(w %a/rdi, w %b/rsi, l %x/rdx, l %y/rcx) {
  %x1 = slot 8, align 8
  %y1 = slot 8, align 8
@2:
  %4 = eq.w %a, 0x0_w ; @21
  br %4, @3, @4
@3:
  st.w 0x0_w, %x ; @6
  st.w 0x1_w, %y ; @7
  jmp @17(%b)
@4:
  %m.1 = rem.w %b, %a ; @8
  %gcd.1/w/rax = call $gcdext(%m.1/rdi, %a/rsi, %x1/rdx, %y1/rcx) ; @9
  %rx.1 = ld.w %x1 ; @10
  %ry.1 = ld.w %y1 ; @11
  %nx.1 = div.w %b, %a ; @12
  %5 = mul.w %nx.1, %rx.1 ; @22
  %6 = sub.w %ry.1, %5 ; @23
  st.w %6, %x ; @15
  st.w %rx.1, %y ; @16
  jmp @17(%gcd.1)
@17(%0):
  ret rax/%0
}
